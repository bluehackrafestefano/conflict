This is from Durmus's device
I made some changes here